"use strict";require("dotenv").config();var express=require("express"),app=express(),cors=require("cors"),Person=require("./models/person");if(app.use(cors()),app.use(express.static("build")),app.use(express.json()),"development"===process.env.NODE_ENV){var morgan=require("morgan");morgan.token("type",function(e,n){return JSON.stringify(n.body)}),app.use(morgan("type"))}app.get("/",function(e,n){n.send("Hello world")}),app.get("/api/persons",function(e,n){var r;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(Person.find({}));case 2:r=e.sent,n.json(r);case 4:case"end":return e.stop()}})}),app.get("/api/persons/:id",function(n,r){var s;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(Person.findById(n.params.id));case 2:s=e.sent,r.json(s);case 4:case"end":return e.stop()}})}),app.get("/info",function(e,n){var r=persons.length;n.send("Phonebook has info for ".concat(r," people.\n ").concat((new Date).toString()))}),app.post("/api/persons",function(e,n){var r=e.body;if(void 0===r.name)return n.status(400).json({error:"name is missing"});new Person({name:r.name,number:r.number,date:new Date}).save().then(function(e){n.json(e)})}),app.delete("/api/persons/:id",function(e,n){var r=Number(e.params.id),s=persons.find(function(e){return e.id===r});s||n.status(404).end(),persons=persons.filter(function(e){return e!==s}),n.status(204).end()});var unknownEndpoint=function(e,n){n.status(404).send({error:"unknown endpoint"})};app.use(unknownEndpoint);var PORT=process.env.PORT||3001;app.listen(PORT,function(){console.log("App is listening on port ".concat(PORT))});