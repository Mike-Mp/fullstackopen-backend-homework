"use strict";var express=require("express"),app=express(),morgan=require("morgan"),cors=require("cors");app.use(cors()),app.use(express.json()),morgan.token("type",function(n,e){return JSON.stringify(e.body)}),app.use(morgan("type"));var persons=[{name:"George",id:1},{name:"Smith",id:2},{name:"Mike",id:3},{name:"Bill",id:4}];app.get("/",function(n,e){e.send("Hello world")}),app.get("/api/persons",function(n,e){e.json(persons)}),app.get("/api/persons/:id",function(n,e){var s=Number(n.params.id),o=persons.find(function(n){return n.id===s});if(!o)return e.status(404).end();e.json(o)}),app.get("/info",function(n,e){var s=persons.length;e.send("Phonebook has info for ".concat(s," people.\n ").concat((new Date).toString()))}),app.post("/api/persons",function(n,e){var s=Math.floor(100*Math.random()),o=n.body,r=persons.find(function(n){return n.name===o.name}),t={name:o.name,id:s};return o.name?r?e.status(304).json({error:"Name already exists"}):(persons=persons.concat(t),void e.json(t)):e.status(304).json({error:"Name has to be included."})}),app.delete("/api/persons/:id",function(n,e){var s=Number(n.params.id),o=persons.find(function(n){return n.id===s});o||e.status(404).end(),persons=persons.filter(function(n){return n!==o}),e.status(204).end()});var unknownEndpoint=function(n,e){e.status(404).send({error:"unknown endpoint"})};app.use(unknownEndpoint);var PORT=process.env.PORT||3001;app.listen(PORT,function(){console.log("App is listening on port ".concat(PORT))});